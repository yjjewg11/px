var KDClassNewPhotoItem=function(q,r,t){var g={callback:null,queryForSelect:function(a,b,d,c){var e;e||(e="");g.callback=c;d=Store.getGroup();a=a?a:d[0].uuid;c=Store.getMyByClassList(a);b=b?b:c&&0!=c.length?c[0].uuid:null;React.render(React.createElement(k,{groupuuid:a,label:e,group_List:G_selected_dataModelArray_byArray(d,"uuid","brand_name"),classList:G_selected_dataModelArray_byArray(c,"uuid","name"),classuuid:b}),G_get_div_second())}},k=React.createClass({displayName:"Query_photo_div",load_more_btn_id:"load_more_",pageNo:1,classnewsreply_list_div:"am-list-newsPhoto-bd",getInitialState:function(){var a=this.query_Label();return{query_My_All_list:1,groupList:this.props.group_List,classList:this.props.classList,queryForm:{groupuuid:this.props.groupuuid,label:this.props.label,classuuid:this.props.classuuid},label_list:a,pageNo:1,show_list:[],list:[]}},query_Label:function(a,b){var d=[];$.ajax({type:"GET",url:hostUrl+"rest/kDPhotoItem/queryLabel.json",data:{group_uuid:a?this.state.queryForm.groupuuid:this.props.groupuuid,class_uuid:b?this.state.queryForm.classuuid:this.props.classuuid},dataType:"json",async:!1,success:function(a){"success"==a.ResMsg.status?(d=a.list,d.push({value:"",label:"\u6240\u6709"}),d.slice(0,-1)):(alert(a.ResMsg.message),G_resMsg_filter(a.ResMsg))},error:G_ajax_error_fn});return d},componentWillReceiveProps:function(){this.load_more_data()},componentDidMount:function(){this.load_more_data()},handle_onKeyDown:function(a){if(G_isKeyDown_enter(a))return this.handleClick_query(),!1},handleClick_query:function(a){this.state.pageNo=1;this.refresh_data()},load_more_data:function(){$("#"+this.classnewsreply_list_div).append("\x3cdiv id\x3d"+this.classnewsreply_list_div+this.pageNo+"\x3e\u52a0\u8f7d\u4e2d...\x3c/div\x3e");var a=this;l(this.classnewsreply_list_div+this.pageNo,this.state.queryForm,this.pageNo,this,function(b){if(b){var d=a.state.totalCount%a.state.pageSize,c=Math.round(a.state.totalCount/a.state.pageSize);b.data.length<b.pageSize?$("#"+a.load_more_btn_id).hide():a.state.pageNo==c&&0==d?$("#"+a.load_more_btn_id).hide():$("#"+a.load_more_btn_id).show();a.pageNo++}});this.setState(this.state)},refresh_data:function(){var a=this.query_Label(this.state.queryForm.groupuuid,this.state.queryForm.classuuid);this.state.label_list=a;this.pageNo=1;$("#"+this.classnewsreply_list_div).html("");this.load_more_data()},handleClick_selectbtn:function(a){var b=[];$("img[name\x3d'KDClassNewsPhotoItem_Img_select']").each(function(){var a={src:null,uuid:null};a.src=$(this).attr("src");a.uuid=$(this).attr("id");b.push(a)});G_get_div_body();g.callback&&g.callback(b)},btn_classPhtotItem:function(){G_photo_groupuuid=this.state.queryForm.groupuuid;G_photo_classuuid=this.state.queryForm.classuuid;KDPhotoItem.query()},All_group_class:function(){var a,b,d,c;b=Store.getGroupNoGroup_wjd();a||(a=b[0].uuid);d=G_selected_dataModelArray_byArray(b,"uuid","brand_name");b=(c=Store.getChooseClass(a))&&0!=c.length?c[0].uuid:null;c=G_selected_dataModelArray_byArray(c,"uuid","name");this.state.pageNo=1;this.state.groupList=d;this.state.classList=c;this.state.queryForm.label="";this.state.queryForm.groupuuid=a;this.state.queryForm.classuuid=b;this.state.query_My_All_list=2;this.refresh_data()},My_group_class:function(){var a,b,d,c;b=Store.getGroup();a||(a=b[0].uuid);d=G_selected_dataModelArray_byArray(b,"uuid","brand_name");b=(c=Store.getMyByClassList(a))&&0!=c.length?c[0].uuid:null;c=G_selected_dataModelArray_byArray(c,"uuid","name");this.state.pageNo=1;this.state.groupList=d;this.state.classList=c;this.state.queryForm.label="";this.state.queryForm.groupuuid=a;this.state.queryForm.classuuid=b;this.state.query_My_All_list=1;this.refresh_data()},handleChange_selectgroup:function(a){var b,d;b=1==this.state.query_My_All_list?Store.getMyByClassList(a):Store.getChooseClass(a);d||(d=b&&0!=b.length?b[0].uuid:null);1==this.state.query_My_All_list&&(G_photo_groupuuid=a,G_photo_classuuid=d);this.state.pageNo=1;this.state.queryForm.label="";this.state.queryForm.groupuuid=a;this.state.queryForm.classuuid=d;this.state.classList=G_selected_dataModelArray_byArray(b,"uuid","name");this.refresh_data()},handleChange:function(a){1==this.state.query_My_All_list&&(G_photo_classuuid=$("input[name\x3d'classuuid']").val());this.state.pageNo=1;this.state.queryForm.label="";this.state.queryForm.classuuid=a;this.refresh_data()},handleChange_label:function(a){1==this.state.query_My_All_list&&(G_photo_classuuid=$("input[name\x3d'classuuid']").val());a=$("#queryForm").serializeJson();this.state.pageNo=1;this.state.queryForm=a;this.refresh_data()},render:function(){this.load_more_btn_id="load_more_"+this.props.uuid;var a,b,d,c=this.state.queryForm,e=this.state,h=[];1==e.query_My_All_list?(d="G_Edit_show",b="G_Edit_hide"):(d="G_Edit_hide",b="G_Edit_show");for(var f=0;f<e.label_list.length;f++)e.label_list[f].label&&(a={value:null,label:null},a.value=e.label_list[f].label,a.label=e.label_list[f].label,h.push(a));this.state.label_list=h;a=0==this.state.list.length?"G_Edit_show":"G_Edit_hide";return React.createElement("div",{"data-am-widget":"list_news",className:"am-list-news am-list-news-default"},React.createElement(AMR_Panel,null,React.createElement(AMR_ButtonToolbar,null,React.createElement(AMR_Button,{className:d,amStyle:"secondary",onClick:this.All_group_class.bind(this)},"\u67e5\u8be2\u6240\u6709\u73ed\u7ea7"),React.createElement(AMR_Button,{className:b,amStyle:"secondary",onClick:this.My_group_class.bind(this)},"\u67e5\u8be2\u6211\u7684\u73ed\u7ea7"))),React.createElement("label",null,"\u56fe\u7247\u603b\u6570\uff1a"+this.state.totalCount+"\u5f20"),React.createElement(AMUIReact.Form,{id:"queryForm",inline:!0,onKeyDown:this.handle_onKeyDown},React.createElement(AMR_ButtonToolbar,null,React.createElement("div",{className:"am-fl am-margin-left-sm am-margin-bottom-xs"},React.createElement(AMUIReact.Selected,{id:"groupuuid",name:"groupuuid",onChange:this.handleChange_selectgroup,btnWidth:"200",data:e.groupList,btnStyle:"primary",value:c.groupuuid})),React.createElement("div",{className:"am-fl am-margin-left-sm am-margin-bottom-xs"},React.createElement(AMUIReact.Selected,{id:"classuuid",name:"classuuid",placeholder:"\u73ed\u7ea7\u5207\u6362",onChange:this.handleChange,btnWidth:"200",data:e.classList,btnStyle:"primary",value:c.classuuid})),React.createElement("div",{className:"am-fl am-margin-left-sm am-margin-bottom-xs"},React.createElement(AMUIReact.Selected,{id:"label",name:"label",placeholder:"\u6807\u7b7e\u5207\u6362",onChange:this.handleChange_label,btnWidth:"200",data:h,btnStyle:"primary",value:c.label})))),React.createElement("div",{className:a},React.createElement("label",null,"\u8be5\u73ed\u7ea7\u76f8\u518c\u6682\u672a\u4e0a\u4f20\u7167\u7247\uff0c\u8bf7\u8df3\u8f6c\u73ed\u7ea7\u76f8\u518c\u4e0a\u4f20\u65b0\u7167\u7247"),React.createElement(AMR_ButtonToolbar,null,React.createElement(AMR_Button,{amSize:"xs",amStyle:"secondary",onClick:this.btn_classPhtotItem.bind(this)},"\u8df3\u8f6c\u73ed\u7ea7\u76f8\u518c"))),React.createElement("div",{id:this.classnewsreply_list_div,className:"am-list-newsPhoto-bd"}),React.createElement("div",{className:"am-list-news-ft"},React.createElement("a",{className:"am-list-news-more am-btn am-btn-default ",id:this.load_more_btn_id,onClick:this.load_more_data.bind(this)},"\u67e5\u770b\u66f4\u591a \u00bb")),React.createElement("div",{id:"abc"},React.createElement(AMR_ButtonToolbar,null,React.createElement(AMR_Button,{amSize:"xs",amStyle:"secondary",onClick:this.handleClick_selectbtn.bind(this,e)},"\u786e\u8ba4\u7167\u7247\u9009\u62e9"))))}}),l=function(a,b,d,c,e){b.pageNo=d;"\u6240\u6709"==b.label&&(b.label="");$.AMUI.progress.start();$.ajax({type:"GET",url:hostUrl+"rest/kDPhotoItem/queryMy.json",data:b,dataType:"json",async:!1,success:function(b){$.AMUI.progress.done();"success"==b.ResMsg.status?(c.state.list=b.list.data,c.state.pageSize=b.list.pageSize,"1"==d&&(c.state.totalCount=b.list.totalCount),React.render(React.createElement(m,{events:b.list,Propsthat:c,responsive:!0,bordered:!0,striped:!0,hover:!0,striped:!0}),document.getElementById(a)),"function"==typeof e&&e(b.list)):(alert(b.ResMsg.message),G_resMsg_filter(b.ResMsg))},error:G_ajax_error_fn})},m=React.createClass({displayName:"Query_photo_rect",getInitialState:function(){return this.props.events},componentWillReceiveProps:function(a){this.setState(this.getStateByPropes(a))},render:function(){for(var a,b=this.state.data,d=[],c=0;c<b.length;c++)a={path:null,uuid:null,label:null},a.path=b[c].path,a.uuid=b[c].uuid,a.label=b[c].label,d.push(a);return React.createElement("div",{className:"am-comment-bd"},React.createElement(n,{imgsList:d,Penthat:this.props.Propsthat}))}}),n=React.createClass({displayName:"Common_mg_Classnew_big_fn",div_onClick:function(a,b){var d=$("#"+a),c="Common_mg_Class_big_fn_"+b.uuid;0<=d.attr("class").indexOf("G_ch_classNews_item_checked")?(d.removeClass("G_ch_classNews_item_checked"),$("#"+c).remove()):(d.addClass("G_ch_classNews_item_checked"),$("#abc").append("\x3cdiv id\x3d'"+c+"'\x3e\u52a0\u8f7d\u4e2d...\x3c/div\x3e"),React.render(React.createElement(p,{url:b.path,parentDivId:c,trid:a,event:b}),document.getElementById(c)))},render:function(){var a=this;if(this.props.imgsList)return React.createElement("div",null,React.createElement("ul",{className:"am-gallery am-avg-sm-3 am-avg-md-4 am-avg-lg-6 am-gallery-imgbordered"},this.props.imgsList.map(function(b){var d=b.path,c=b.label;c||(c="\u65e0");return React.createElement("li",{id:"Common_mg_ClassNew_big_fn_item_"+b.uuid,className:"G_class_phtoto_Img  G_ch_classNews_item ",title:b.uuid,onClick:a.div_onClick.bind(this,"Common_mg_ClassNew_big_fn_item_"+b.uuid,b)},React.createElement("div",{className:"am-gallery-item"},React.createElement("img",{src:d}),React.createElement("label",null,"\u6807\u7b7e\uff1a\u3010"+c+"\u3011")))})))}}),p=React.createClass({displayName:"KDClassNewsPhotoItem_Img_canDel",deleteImg:function(a,b){var d=$("#"+b);$("#"+a).remove();d.removeClass("G_ch_classNews_item_checked")},render:function(){return React.createElement("div",{className:"G_cookplan_Img"},React.createElement("img",{name:"KDClassNewsPhotoItem_Img_select",className:"G_cookplan_Img_img",id:this.props.event.uuid,src:this.props.url,alt:"\u56fe\u7247\u4e0d\u5b58\u5728"}),React.createElement("div",{className:"G_cookplan_Img_close",onClick:this.deleteImg.bind(this,this.props.parentDivId,this.props.trid)},React.createElement("img",{src:hostUrlCDN+"i/close.png",border:"0"})))}});return g}();