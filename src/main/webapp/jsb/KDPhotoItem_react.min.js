var KDPhotoItem=function(l,m,n){var c={cropper:null,callbackFN:null,type:4,base64:null,groupuuid:null,do_lrz:function(){var b=c.upload_files_arr.pop();b&&lrz(b,{before:function(){console.log("\u538b\u7f29\u5f00\u59cb")},fail:function(a){console.error(a)},always:function(){console.log("\u538b\u7f29\u7ed3\u675f")},done:function(a){console.log(a);a&&a.base64&&c.ajax_uploadByphone(a.base64)}})},upload_files_arr:[],bind_onchange:function(b,a){c.upload_files_arr=[];c.groupuuid=null;c.callbackFN=a;G_CallPhoneFN.isPhoneApp()?$(b).bind("click",function(){G_CallPhoneFN.selectImgPic()}):$(b).bind("change",function(){for(var a=0;a<this.files.length;a++)c.upload_files_arr.push(this.files[a]);c.do_lrz()})},ajax_uploadByphone:function(b){$.AMUI.progress.start();$.ajax({type:"POST",url:hostUrl+"rest/kDPhotoItem/uploadBase64.json",timeout:0,dataType:"json",data:{groupuuid:c.groupuuid,classuuid:null,base64:b},async:!0,success:function(a){$.AMUI.progress.done();"success"==a.ResMsg.status?c.callbackFN&&(c.callbackFN(a.imgUrl,a.data.uuid),c.do_lrz()):alert(a.ResMsg.message)},error:G_ajax_error_fn})}},k=React.createClass({displayName:"Query_photo_rect",getInitialState:function(){return{groupuuid:this.props.groupuuid,class_uuid:this.props.class_uuid,pageNo:this.props.pageNo}},handleChange_selectClass:function(b){this.state.class_uuid=b;this.setState(this.state);menu_photo_fn(this.state.groupuuid,b,this.state.pageNo)},handleChange_selectGroup:function(b){this.state.groupuuid=b;this.state.class_uuid=null;this.setState(this.state);menu_photo_fn(b,this.state.class_uuid,this.state.pageNo)},handleClick:function(b){React.render(React.createElement(h,{formdata:b}),G_get_div_body())},pageClick:function(b){var a=this.state;"pre"==b?2>a.pageNo?G_msg_pop("\u7b2c\u4e00\u9875\u4e86"):(--a.pageNo,menu_photo_fn(a.groupuuid,a.class_uuid,a.pageNo)):"next"==b&&(!a.list||a.list.length<a.pageSize?G_msg_pop("\u6700\u540e\u4e00\u9875\u4e86"):(a.pageNo+=1,menu_photo_fn(a.groupuuid,a.class_uuid,a.pageNo)))},render:function(){var b=this.state,a=this.props.formdata.list.data;return React.createElement("div",null,React.createElement("div",{className:"header"},React.createElement("hr",null)),React.createElement(AMR_Panel,null,React.createElement(AMR_ButtonToolbar,null,React.createElement(AMR_Button,{amStyle:"default",onClick:this.pageClick.bind(this,"pre")},"\u4e0a\u4e00\u9875"),React.createElement(AMR_Button,{amStyle:"default",disabled:"false"},"\u7b2c",b.pageNo,"\u9875"),React.createElement(AMR_Button,{amStyle:"default",onClick:this.pageClick.bind(this,"next")},"\u4e0b\u4e00\u9875"),React.createElement(AMR_Button,{amSize:"xs",amStyle:"secondary",onClick:this.handleClick.bind(this,b)},"\u4e0a\u4f20\u7167\u7247"))),React.createElement(AMR_ButtonToolbar,null,React.createElement("div",{className:"am-fl am-margin-left-sm am-margin-bottom-xs"},React.createElement(AMUIReact.Selected,{id:"groupuuid",name:"groupuuid",onChange:this.handleChange_selectGroup,btnWidth:"200",data:this.props.group_List,btnStyle:"primary",value:b.groupuuid})),React.createElement("div",{className:"am-fl am-margin-left-sm am-margin-bottom-xs"},React.createElement(AMUIReact.Selected,{id:"classuuid",name:"classuuid",placeholder:"\u73ed\u7ea7\u5207\u6362",onChange:this.handleChange_selectClass,btnWidth:"200",data:this.props.classList,btnStyle:"primary",value:b.class_uuid}))),a.map(function(a){return React.createElement(AMUIReact.Image,{className:"am-show",id:"img_image",thumbnail:!0,width:"120",height:"120",src:a.path})}))}}),h=React.createClass({displayName:"Img_photo_rect",buttion_black_Click:function(b){menu_photo_fn(b.groupuuid,b.class_uuid,b.pageNo)},imgDivNum:0,getNewImgDiv:function(){this.imgDivNum++;return"Classnews_edit_"+this.imgDivNum},addShowImg:function(b){var a=this.getNewImgDiv();$("#show_imgList").append("\x3cdiv id\x3d'"+a+"'\x3e\u52a0\u8f7d\u4e2d...\x3c/div\x3e");React.render(React.createElement(ClassNews_Img_canDel,{url:b,parentDivId:a}),document.getElementById(a))},upload_files_arr:[],componentDidMount:function(){this.editor=$("#classnews_content").xheditor(xhEditor_classnews_emot);var b=this;c.bind_onchange("#file_img_upload",function(a,c){b.addShowImg(a)});c.groupuuid=this.props.formdata.groupuuid;if($("#imgs").val())for(var a=$("#imgs").val().split(","),e=0;e<a.length;e++)this.addShowImg(a[e])},render:function(){var b=this.props.formdata;return React.createElement("div",null,React.createElement("div",{className:"header"},React.createElement("hr",null)),React.createElement("div",{className:"am-g"},React.createElement("form",{id:"KdPhotoForm",method:"post",className:"am-form"},React.createElement("input",{type:"hidden",name:"group_uuid",value:b.groupuuid}),React.createElement(AMR_ButtonToolbar,null,React.createElement(AMR_Button,{amSize:"xs",amStyle:"secondary",onClick:this.buttion_black_Click.bind(this,b)},"\u8fd4\u56de"))),React.createElement("div",{id:"show_imgList"}),React.createElement("br",null),React.createElement("div",{className:"cls"}),React.createElement(AMR_Input,{type:"file",label:"",id:"file_img_upload",help:"\u9009\u62e9\u56fe\u7247",accept:"image/*",capture:"camera",multiple:!0})))}});return{query:function(b,a,c){var f,g=Store.getGroup();f=b?b:g[0].uuid;var d=Store.getChooseClass(f);c||(c=1);a||(a=d&&0!=d.length?d[0].uuid:null);$.ajax({type:"GET",url:hostUrl+"rest/kDPhotoItem/queryMy.json",data:{class_uuid:a,pageNo:c},dataType:"json",success:function(b){"success"==b.ResMsg.status?React.render(React.createElement(k,{formdata:b,groupuuid:f,pageNo:c,group_List:G_selected_dataModelArray_byArray(g,"uuid","brand_name"),classList:G_selected_dataModelArray_byArray(d,"uuid","name"),class_uuid:a}),G_get_div_body()):alert("\u52a0\u8f7d\u6570\u636e\u5931\u8d25\uff1a"+b.ResMsg.message)},error:G_ajax_error_fn})}}}();