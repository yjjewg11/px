var KDPhotoItem=function(n,p,q,r){var g={callback:null,queryForSelect:function(a,b,c,f,d){g.callback=d;c=Store.getGroup();a=a?a:c[0].uuid;d=Store.getChooseClass(a);b||(b=d&&0!=d.length?d[0].uuid:null);React.render(React.createElement(h,{groupuuid:a,type:f,group_List:G_selected_dataModelArray_byArray(c,"uuid","brand_name"),classList:G_selected_dataModelArray_byArray(d,"uuid","name"),class_uuid:b}),G_get_div_second())},query:function(a,b,c,f){c=Store.getGroup();a=a?a:c[0].uuid;var d=Store.getChooseClass(a);b||(b=d&&0!=d.length?d[0].uuid:null);React.render(React.createElement(h,{groupuuid:a,type:f,group_List:G_selected_dataModelArray_byArray(c,"uuid","brand_name"),classList:G_selected_dataModelArray_byArray(d,"uuid","name"),class_uuid:b}),G_get_div_body())}},e={cropper:null,callbackFN:null,type:4,base64:null,groupuuid:null,do_lrz:function(){var a=e.upload_files_arr.pop();a&&lrz(a,{before:function(){console.log("\u538b\u7f29\u5f00\u59cb")},fail:function(a){console.error(a)},always:function(){console.log("\u538b\u7f29\u7ed3\u675f")},done:function(a){console.log(a);a&&a.base64&&e.ajax_uploadByphone(a.base64)}})},upload_files_arr:[],bind_onchange:function(a,b){e.upload_files_arr=[];e.groupuuid=null;e.callbackFN=b;G_CallPhoneFN.isPhoneApp()?$(a).bind("click",function(){G_CallPhoneFN.selectImgPic()}):$(a).bind("change",function(){for(var a=0;a<this.files.length;a++)e.upload_files_arr.push(this.files[a]);e.do_lrz()})},ajax_uploadByphone:function(a){$.AMUI.progress.start();formObject=$("#KdPhotoForm").serializeJson();formObject.base64=a;$.ajax({type:"POST",url:hostUrl+"rest/kDPhotoItem/uploadBase64.json",timeout:0,dataType:"json",data:formObject,async:!0,success:function(a){$.AMUI.progress.done();"success"==a.ResMsg.status?e.callbackFN&&(e.callbackFN(a.imgUrl,a.data.uuid),e.do_lrz()):alert(a.ResMsg.message)},error:G_ajax_error_fn})}},k=React.createClass({displayName:"KDPhotoItem_Img_canDel",deleteImg:function(a){$("#"+a).remove()},render:function(){return React.createElement("div",{className:"G_cookplan_Img"},React.createElement("img",{name:"KDPhotoItem_Img_select",className:"G_cookplan_Img_img",src:this.props.url,alt:"\u56fe\u7247\u4e0d\u5b58\u5728"}),React.createElement("div",{className:"G_cookplan_Img_close",onClick:this.deleteImg.bind(this,this.props.parentDivId)},React.createElement("img",{src:hostUrlCDN+"i/close.png",border:"0"})))}}),l=React.createClass({displayName:"Common_mg_Class_big_fn",buttion_select:function(a){var b="Common_mg_Class_big_fn_"+a.uuid;$("#abc").append("\x3cdiv id\x3d'"+b+"'\x3e\u52a0\u8f7d\u4e2d...\x3c/div\x3e");React.render(React.createElement(k,{url:a.path,parentDivId:b}),document.getElementById(b))},handleClick:function(a){if(confirm("\u786e\u5b9a\u8981\u5220\u9664\u5417?")){var b=a.uuid;$.AMUI.progress.start();$.ajax({type:"POST",url:hostUrl+"rest/kDPhotoItem/delete.json?uuid\x3d"+b,dataType:"json",async:!0,success:function(a){$.AMUI.progress.done();"success"==a.ResMsg.status?$("#Common_mg_Class_big_fn_item_"+b).remove():alert(a.ResMsg.message)},error:G_ajax_error_fn})}},render:function(){var a=this,b;if(this.props.imgsList)return b=1==this.props.state.type?"G_Edit_show":"G_Edit_hide",React.createElement("div",null,React.createElement("ul",{className:"am-gallery am-avg-sm-3 am-avg-md-4 am-avg-lg-6 am-gallery-imgbordered"},this.props.imgsList.map(function(c){var f=c.path,d=f?f.split("@"):"";return React.createElement("li",{id:"Common_mg_Class_big_fn_item_"+c.uuid},React.createElement("div",{className:"am-gallery-item"},React.createElement("a",{href:d[0],title:""},React.createElement("img",{src:f,alt:"","data-rel":d[0]})),React.createElement("div",{className:"am-fl am-margin-bottom-xs am-margin-left-xs"},React.createElement(AMR_Button,{className:b,amStyle:"secondary",onClick:a.buttion_select.bind(this,c)},"\u9009\u62e9\u7167\u7247")),React.createElement("div",{className:"am-fl am-margin-bottom-xs am-margin-left-xs"},React.createElement(AMR_Button,{amStyle:"secondary",onClick:a.handleClick.bind(this,c)},"\u5220\u9664\u7167\u7247"))))})))}}),h=React.createClass({displayName:"Query_photo_rect",getStateByPropes:function(a){return{queryForm:{groupuuid:this.props.groupuuid,class_uuid:this.props.class_uuid},pageNo:1,type:a.type,show_list:[],list:[]}},componentWillReceiveProps:function(a){this.setState(this.getStateByPropes(a))},getInitialState:function(){return this.getStateByPropes(this.props)},handleChange_selectgroup:function(a){a=Store.getChooseClass($("input[name\x3d'groupuuid']").val());this.state.queryForm.groupuuid=$("input[name\x3d'groupuuid']").val();this.state.queryForm.classuuid=$("input[name\x3d'class_uuid']").val();this.state.classlist=G_selected_dataModelArray_byArray(a,"uuid","name");this.ajax_list();this.setState(this.state)},handleChange:function(a){a=$("#queryForm").serializeJson();this.state.queryForm=a;this.setState(this.state);this.ajax_list()},handleClick:function(a){React.render(React.createElement(m,{formdata:a}),G_get_div_body())},handleClick_selectbtn:function(a){var b=[];$("img[name\x3d'KDPhotoItem_Img_select']").each(function(){b.push($(this).attr("src"))});g.callback&&g.callback(b);G_get_div_body()},pageClick:function(a,b){var c=this.state;"pre"==a?2>c.pageNo?G_msg_pop("\u7b2c\u4e00\u9875\u4e86"):(--c.pageNo,this.ajax_list(c)):"next"==a&&(!b||b.length<c.pageSize?G_msg_pop("\u6700\u540e\u4e00\u9875\u4e86"):(c.pageNo+=1,this.ajax_list(c)))},handleClick_query:function(a){this.state.pageNo=1;this.ajax_list()},ajax_callback:function(a){this.state.list=null==a?[]:a.data;this.state.pageSize=a.pageSize;"1"==this.state.pageNo&&(this.state.totalCount=a.totalCount);this.setState(this.state)},ajax_list:function(){var a=this.state.queryForm;a.pageNo=this.state.pageNo;$.AMUI.progress.start();var b=this;$.ajax({type:"GET",url:hostUrl+"rest/kDPhotoItem/queryMy.json",data:a,dataType:"json",success:function(a){$.AMUI.progress.done();"success"==a.ResMsg.status?b.ajax_callback(a.list):(alert(a.ResMsg.message),G_resMsg_filter(a.ResMsg))},error:G_ajax_error_fn})},componentDidMount:function(){this.ajax_list();$(".am-gallery").pureview()},handle_onKeyDown:function(a){if(G_isKeyDown_enter(a))return this.handleClick_query(),!1},render:function(){var a,b,c=this.state.queryForm,f=this.state;a=this.state.list;a.pageNo=this.state.pageNo;for(var d=[],e=0;e<a.length;e++)b={path:null,groupuuid:null,class_uuid:null,uuid:null,pageNo:null},b.path=a[e].path,b.groupuuid=f.queryForm.groupuuid,b.class_uuid=f.queryForm.class_uuid,b.uuid=a[e].uuid,b.pageNo=f.pageNo,d.push(b);1==f.type?(a="G_Edit_hide",b="G_Edit_show"):(a="G_Edit_show",b="G_Edit_hide");return React.createElement("div",null,React.createElement("div",{className:"header"},React.createElement("hr",null)),React.createElement(AMR_Panel,null,React.createElement(AMR_ButtonToolbar,null,React.createElement(AMR_Button,{amStyle:"default",onClick:this.pageClick.bind(this,"pre",d)},"\u4e0a\u4e00\u9875"),React.createElement(AMR_Button,{amStyle:"default",disabled:"false"},"\u7b2c",f.pageNo,"\u9875"),React.createElement(AMR_Button,{amStyle:"default",onClick:this.pageClick.bind(this,"next",d)},"\u4e0b\u4e00\u9875"),React.createElement(AMR_Button,{className:a,amSize:"xs",amStyle:"secondary",onClick:this.handleClick.bind(this,f)},"\u4e0a\u4f20\u7167\u7247"))),React.createElement(AMUIReact.Form,{id:"queryForm",inline:!0,onKeyDown:this.handle_onKeyDown},React.createElement(AMR_ButtonToolbar,null,React.createElement("div",{className:"am-fl am-margin-left-sm am-margin-bottom-xs"},React.createElement(AMUIReact.Selected,{id:"groupuuid",name:"groupuuid",onChange:this.handleChange_selectgroup,btnWidth:"200",data:this.props.group_List,btnStyle:"primary",value:c.groupuuid})),React.createElement("div",{className:"am-fl am-margin-left-sm am-margin-bottom-xs"},React.createElement(AMUIReact.Selected,{id:"classuuid",name:"classuuid",placeholder:"\u73ed\u7ea7\u5207\u6362",onChange:this.handleChange,btnWidth:"200",data:this.props.classList,btnStyle:"primary",value:c.class_uuid})))),React.createElement("div",{className:"am-comment-bd"},React.createElement(l,{imgsList:d,state:this.state})),React.createElement("div",{id:"abc"},React.createElement("legend",null),React.createElement(AMR_ButtonToolbar,null,React.createElement(AMR_Button,{className:b,amSize:"xs",amStyle:"secondary",onClick:this.handleClick_selectbtn.bind(this,f)},"\u786e\u8ba4\u7167\u7247\u9009\u62e9"))))}}),m=React.createClass({displayName:"Img_photo_rect",buttion_black_Click:function(a){g.query(a.queryForm.groupuuid,a.queryForm.class_uuid,a.pageNo,a.type)},imgDivNum:0,getNewImgDiv:function(){this.imgDivNum++;return"Classnews_edit_"+this.imgDivNum},addShowImg:function(a){var b=this.getNewImgDiv();$("#show_imgList").append("\x3cdiv id\x3d'"+b+"'\x3e\u52a0\u8f7d\u4e2d...\x3c/div\x3e");React.render(React.createElement(ClassNews_Img_canDel,{url:a,parentDivId:b}),document.getElementById(b))},upload_files_arr:[],componentDidMount:function(){this.editor=$("#classnews_content").xheditor(xhEditor_classnews_emot);var a=this;e.bind_onchange("#file_img_upload",function(b,c){a.addShowImg(b)});e.groupuuid=this.props.formdata.groupuuid;if($("#imgs").val())for(var b=$("#imgs").val().split(","),c=0;c<b.length;c++)this.addShowImg(b[c])},render:function(){var a=this.props.formdata;return React.createElement("div",null,React.createElement("div",{className:"header"},React.createElement("hr",null)),React.createElement("div",{className:"am-g"},React.createElement("form",{id:"KdPhotoForm",method:"post",className:"am-form"},React.createElement("input",{type:"hidden",name:"group_uuid",value:a.queryForm.groupuuid}),React.createElement("input",{type:"hidden",name:"class_uuid",value:a.queryForm.class_uuid}),React.createElement(AMR_ButtonToolbar,null,React.createElement(AMR_Button,{amSize:"xs",amStyle:"secondary",onClick:this.buttion_black_Click.bind(this,a)},"\u8fd4\u56de"))),React.createElement("div",{id:"show_imgList"}),React.createElement("br",null),React.createElement("div",{className:"cls"}),React.createElement(AMR_Input,{type:"file",label:"",id:"file_img_upload",help:"\u9009\u62e9\u56fe\u7247",accept:"image/*",capture:"camera",multiple:!0})))}});return g}();