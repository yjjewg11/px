var KDPhotoItem=function(q,r,t,u){var h={callback:null,ajax_uploadByphone:function(a){g.ajax_uploadByphone(a)},queryForSelect:function(a,b,c,d,e){var f;h.callback=e;c=Store.getGroup();a=a?a:c[0].uuid;e=Store.getChooseClass(a);f||(f="");b||(b=e&&0!=e.length?e[0].uuid:null);React.render(React.createElement(l,{groupuuid:a,type:d,label:f,group_List:G_selected_dataModelArray_byArray(c,"uuid","brand_name"),classList:G_selected_dataModelArray_byArray(e,"uuid","name"),class_uuid:b}),G_get_div_second())},query:function(a,b,c,d){var e;c=Store.getGroup();a=a?a:c[0].uuid;var f=Store.getChooseClass(a);e||(e="");b||(b=f&&0!=f.length?f[0].uuid:null);React.render(React.createElement(l,{groupuuid:a,label:e,type:d,group_List:G_selected_dataModelArray_byArray(c,"uuid","brand_name"),classList:G_selected_dataModelArray_byArray(f,"uuid","name"),class_uuid:b}),G_get_div_body())}},g={cropper:null,callbackFN:null,type:4,base64:null,groupuuid:null,do_lrz:function(){var a=g.upload_files_arr.pop();a&&lrz(a,{before:function(){console.log("\u538b\u7f29\u5f00\u59cb")},fail:function(a){console.error(a)},always:function(){console.log("\u538b\u7f29\u7ed3\u675f")},done:function(a){console.log(a);a&&a.base64&&g.ajax_uploadByphone(a.base64)}})},upload_files_arr:[],bind_onchange:function(a,b){g.upload_files_arr=[];g.groupuuid=null;g.callbackFN=b;window.JavaScriptCall&&window.JavaScriptCall.selectImgForCallBack?$(a).bind("click",function(){G_CallPhoneFN.selectImgForCallBack("KDPhotoItem.ajax_uploadByphone","0","500")}):$(a).bind("change",function(){for(var a=0;a<this.files.length;a++)g.upload_files_arr.push(this.files[a]);g.do_lrz()})},ajax_uploadByphone:function(a){$.AMUI.progress.start();formObject=$("#KdPhotoForm").serializeJson();formObject.base64=a;$.ajax({type:"POST",url:hostUrl+"rest/kDPhotoItem/uploadBase64.json",timeout:0,dataType:"json",data:formObject,async:!0,success:function(a){$.AMUI.progress.done();"success"==a.ResMsg.status?g.callbackFN&&(g.callbackFN(a.imgUrl,a.data.uuid),g.do_lrz()):alert(a.ResMsg.message)},error:G_ajax_error_fn})}},m=React.createClass({displayName:"KDPhotoItem_Img_canDel",deleteImg:function(a){$("#"+a).remove()},render:function(){return React.createElement("div",{className:"G_cookplan_Img"},React.createElement("img",{name:"KDPhotoItem_Img_select",className:"G_cookplan_Img_img",src:this.props.url,alt:"\u56fe\u7247\u4e0d\u5b58\u5728"}),React.createElement("div",{className:"G_cookplan_Img_close",onClick:this.deleteImg.bind(this,this.props.parentDivId)},React.createElement("img",{src:hostUrlCDN+"i/close.png",border:"0"})))}}),n=React.createClass({displayName:"Common_mg_Class_big_fn",buttion_select:function(a){var b=$("#Common_mg_Class_big_fn_item_checkbox"+a.uuid),c="Common_mg_Class_big_fn_"+a.uuid;b.prop("checked")?($("#abc").append("\x3cdiv id\x3d'"+c+"'\x3e\u52a0\u8f7d\u4e2d...\x3c/div\x3e"),React.render(React.createElement(m,{url:a.path,parentDivId:c}),document.getElementById(c))):$("#"+c).remove()},handleClick:function(a){if(confirm("\u786e\u5b9a\u8981\u5220\u9664\u5417?")){var b=a.uuid;$.AMUI.progress.start();$.ajax({type:"POST",url:hostUrl+"rest/kDPhotoItem/delete.json?uuid\x3d"+b,dataType:"json",async:!0,success:function(a){$.AMUI.progress.done();"success"==a.ResMsg.status?$("#Common_mg_Class_big_fn_item_"+b).remove():alert(a.ResMsg.message)},rror:G_ajax_error_fn})}},render:function(){var a=this,b;if(this.props.imgsList)return b=1==this.props.state.type?"G_Edit_show":"G_Edit_hide",React.createElement("div",null,React.createElement("ul",{className:"am-gallery am-avg-sm-3 am-avg-md-4 am-avg-lg-6 am-gallery-imgbordered"},this.props.imgsList.map(function(c){var d=c.path,e=d?d.split("@"):"";return React.createElement("li",{id:"Common_mg_Class_big_fn_item_"+c.uuid,className:"G_class_phtoto_Img"},React.createElement("div",{className:"am-gallery-item"},React.createElement("a",{href:e[0],title:""},React.createElement("img",{src:d,alt:"","data-rel":e[0]}))),React.createElement("div",{className:"G_class_phtoto_Img_select"},React.createElement("input",{id:"Common_mg_Class_big_fn_item_checkbox"+c.uuid,type:"checkbox",className:b,onClick:a.buttion_select.bind(this,c),name:"table_checkbox"})),React.createElement("div",{className:"G_class_phtoto_Img_close  am-fl am-margin-bottom-xs am-margin-left-xs"},React.createElement(AMR_Button,{onClick:a.handleClick.bind(this,c)},"X")))})))}}),k=[],l=React.createClass({displayName:"Query_photo_rect",getInitialState:function(){return this.getStateByPropes(this.props)},getStateByPropes:function(a){var b=[];$.ajax({type:"GET",url:hostUrl+"rest/kDPhotoItem/queryLabel.json",data:{group_uuid:this.props.groupuuid,class_uuid:this.props.class_uuid},dataType:"json",async:!1,success:function(a){"success"==a.ResMsg.status?(b=a.list,b.push({value:"",label:"\u6240\u6709"}),k=b.slice(0,-1)):(alert(a.ResMsg.message),G_resMsg_filter(a.ResMsg))},error:G_ajax_error_fn});return{queryForm:{groupuuid:this.props.groupuuid,label:this.props.label,class_uuid:this.props.class_uuid},label_list:b,pageNo:1,type:a.type,show_list:[],list:[]}},componentWillReceiveProps:function(a){this.setState(this.getStateByPropes(a))},handleChange_selectgroup:function(a){a=Store.getChooseClass($("input[name\x3d'groupuuid']").val());this.state.queryForm.groupuuid=$("input[name\x3d'groupuuid']").val();this.state.queryForm.classuuid=$("input[name\x3d'class_uuid']").val();this.state.classlist=G_selected_dataModelArray_byArray(a,"uuid","name");this.ajax_list();this.setState(this.state)},handleChange:function(a){a=$("#queryForm").serializeJson();this.state.queryForm=a;this.setState(this.state);this.ajax_list()},handleClick:function(a){React.render(React.createElement(p,{formdata:a}),G_get_div_body())},handleClick_selectbtn:function(a){var b=[];$("img[name\x3d'KDPhotoItem_Img_select']").each(function(){b.push($(this).attr("src"))});h.callback&&h.callback(b);G_get_div_body()},pageClick:function(a,b){var c=this.state;"pre"==a?2>c.pageNo?G_msg_pop("\u7b2c\u4e00\u9875\u4e86"):(--c.pageNo,this.ajax_list(c)):"next"==a&&(!b||b.length<c.pageSize?G_msg_pop("\u6700\u540e\u4e00\u9875\u4e86"):(c.pageNo+=1,this.ajax_list(c)))},handleClick_query:function(a){this.state.pageNo=1;this.ajax_list()},ajax_callback:function(a){this.state.list=null==a?[]:a.data;this.state.pageSize=a.pageSize;"1"==this.state.pageNo&&(this.state.totalCount=a.totalCount);this.setState(this.state)},ajax_list:function(){var a=this.state.queryForm;"\u6240\u6709"==a.label&&(a.label="");a.pageNo=this.state.pageNo;$.AMUI.progress.start();var b=this;$.ajax({type:"GET",url:hostUrl+"rest/kDPhotoItem/queryMy.json",data:a,dataType:"json",success:function(a){$.AMUI.progress.done();"success"==a.ResMsg.status?b.ajax_callback(a.list):(alert(a.ResMsg.message),G_resMsg_filter(a.ResMsg))},error:G_ajax_error_fn})},componentDidMount:function(){this.ajax_list();$(".am-gallery").pureview()},handle_onKeyDown:function(a){if(G_isKeyDown_enter(a))return this.handleClick_query(),!1},render:function(){var a,b,c=this.state.queryForm,d=this.state;a=this.state.list;a.pageNo=this.state.pageNo;var e=[],f,g=[];for(b=0;b<d.label_list.length;b++)d.label_list[b].label&&(f={value:null,label:null},f.value=d.label_list[b].label,f.label=d.label_list[b].label,g.push(f));this.state.label_list=g;for(b=0;b<a.length;b++)f={path:null,groupuuid:null,class_uuid:null,uuid:null,pageNo:null},f.path=a[b].path,f.groupuuid=d.queryForm.groupuuid,f.class_uuid=d.queryForm.class_uuid,f.uuid=a[b].uuid,f.pageNo=d.pageNo,e.push(f);1==d.type?(a="G_Edit_hide",b="G_Edit_show"):(a="G_Edit_show",b="G_Edit_hide");return React.createElement("div",null,React.createElement("div",{className:"header"},React.createElement("hr",null)),React.createElement(AMR_Panel,null,React.createElement(AMR_ButtonToolbar,null,React.createElement(AMR_Button,{amStyle:"default",onClick:this.pageClick.bind(this,"pre",e)},"\u4e0a\u4e00\u9875"),React.createElement(AMR_Button,{amStyle:"default",disabled:"false"},"\u7b2c",d.pageNo,"\u9875"),React.createElement(AMR_Button,{amStyle:"default",onClick:this.pageClick.bind(this,"next",e)},"\u4e0b\u4e00\u9875"),React.createElement(AMR_Button,{className:a,amSize:"xs",amStyle:"secondary",onClick:this.handleClick.bind(this,d)},"\u4e0a\u4f20\u7167\u7247"))),React.createElement(AMUIReact.Form,{id:"queryForm",inline:!0,onKeyDown:this.handle_onKeyDown},React.createElement(AMR_ButtonToolbar,null,React.createElement("div",{className:"am-fl am-margin-left-sm am-margin-bottom-xs"},React.createElement(AMUIReact.Selected,{id:"groupuuid",name:"groupuuid",onChange:this.handleChange_selectgroup,btnWidth:"200",data:this.props.group_List,btnStyle:"primary",value:c.groupuuid})),React.createElement("div",{className:"am-fl am-margin-left-sm am-margin-bottom-xs"},React.createElement(AMUIReact.Selected,{id:"classuuid",name:"classuuid",placeholder:"\u73ed\u7ea7\u5207\u6362",onChange:this.handleChange,btnWidth:"200",data:this.props.classList,btnStyle:"primary",value:c.class_uuid})),React.createElement("div",{className:"am-fl am-margin-left-sm am-margin-bottom-xs"},React.createElement(AMUIReact.Selected,{id:"label",name:"label",placeholder:"\u6807\u7b7e\u5207\u6362",onChange:this.handleChange,btnWidth:"200",data:g,btnStyle:"primary",value:c.label})))),React.createElement("div",{className:"am-comment-bd"},React.createElement(n,{imgsList:e,state:this.state})),React.createElement("legend",null),React.createElement(AMR_ButtonToolbar,null,React.createElement(AMR_Button,{amStyle:"default",onClick:this.pageClick.bind(this,"pre",e)},"\u4e0a\u4e00\u9875"),React.createElement(AMR_Button,{amStyle:"default",disabled:"false"},"\u7b2c",d.pageNo,"\u9875"),React.createElement(AMR_Button,{amStyle:"default",onClick:this.pageClick.bind(this,"next",e)},"\u4e0b\u4e00\u9875")),React.createElement("div",{id:"abc"},React.createElement(AMR_ButtonToolbar,null,React.createElement(AMR_Button,{className:b,amSize:"xs",amStyle:"secondary",onClick:this.handleClick_selectbtn.bind(this,d)},"\u786e\u8ba4\u7167\u7247\u9009\u62e9"))))}}),p=React.createClass({displayName:"Img_photo_rect",getInitialState:function(){for(var a,b=0;b<k.length;b++)k[b].label&&(a={value:null,label:null},a.value=k[b].label,a.label=k[b].label,this.props.formdata.show_list.push(a));return this.props.formdata},buttion_black_Click:function(a){h.query(a.queryForm.groupuuid,a.queryForm.class_uuid,a.pageNo,a.type)},imgDivNum:0,getNewImgDiv:function(){this.imgDivNum++;return"Classnews_edit_"+this.imgDivNum},addShowImg:function(a){var b=this.getNewImgDiv();$("#show_imgList").append("\x3cdiv id\x3d'"+b+"'\x3e\u52a0\u8f7d\u4e2d...\x3c/div\x3e");React.render(React.createElement(ClassNews_Img_canDel,{url:a,parentDivId:b}),document.getElementById(b))},upload_files_arr:[],componentDidMount:function(){this.editor=$("#classnews_content").xheditor(xhEditor_classnews_emot);var a=this;g.bind_onchange("#file_img_upload",function(b,c){a.addShowImg(b)});g.groupuuid=this.props.formdata.groupuuid;if($("#imgs").val())for(var b=$("#imgs").val().split(","),c=0;c<b.length;c++)this.addShowImg(b[c])},handleChange:function(){var a=$("input[name\x3d'label']").val();this.state.queryForm.label=a;this.setState(this.state);this.setState($("#KdPhotoForm").serializeJson())},handleChange_label:function(a){this.state.queryForm.label=a;this.setState(this.state);this.setState($("#KdPhotoForm").serializeJson())},render:function(){var a=this.state,b=React.createElement(AMR_Input,{type:"file",label:"\u4e0a\u4f20\u56fe\u7247",id:"file_img_upload",help:"\u9009\u62e9\u56fe\u7247",accept:"image/*",capture:"camera",multiple:!0});window.JavaScriptCall&&window.JavaScriptCall.selectImgForCallBack&&(b=React.createElement(AMR_Button,{amStyle:"primary",id:"file_img_upload"},"\u4e0a\u4f20\u56fe\u7247"));return React.createElement("div",null,React.createElement("div",{className:"header"},React.createElement("hr",null)),React.createElement("div",{className:"am-g"},React.createElement("form",{id:"KdPhotoForm",method:"post",className:"am-form"},React.createElement("input",{type:"hidden",name:"group_uuid",value:a.queryForm.groupuuid}),React.createElement("input",{type:"hidden",name:"class_uuid",value:a.queryForm.classuuid}),React.createElement(AMR_ButtonToolbar,null,React.createElement(AMR_Button,{amSize:"xs",amStyle:"secondary",onClick:this.buttion_black_Click.bind(this,a)},"\u8fd4\u56de"),React.createElement("div",{className:"am-fl am-margin-left-sm am-margin-bottom-xs"},React.createElement(AMUIReact.Selected,{id:"label_Selected",name:"label_Selected",placeholder:"\u6807\u7b7e\u5207\u6362",onChange:this.handleChange_label,btnWidth:"200",data:a.show_list,btnStyle:"primary",value:a.queryForm.label}))),React.createElement("label",{className:"am-u-lg-2 am-u-md-2 am-u-sm-4 am-form-label"},"\u6807\u7b7e:"),React.createElement("div",{className:"am-u-lg-10 am-u-md-10 am-u-sm-8"},React.createElement(PxInput,{type:"text",name:"label",id:"label",value:a.queryForm.label,onChange:this.handleChange,maxLength:"45",placeholder:"\u4e0d\u8d85\u8fc745\u4f4d"}))),React.createElement("div",{id:"show_imgList"}),React.createElement("br",null),React.createElement("div",{className:"cls"}),b))}});return h}();