var KDPhotoItem=function(k,l,m){var d={cropper:null,callbackFN:null,type:4,base64:null,groupuuid:null,do_lrz:function(){var a=d.upload_files_arr.pop();a&&lrz(a,{before:function(){console.log("\u538b\u7f29\u5f00\u59cb")},fail:function(a){console.error(a)},always:function(){console.log("\u538b\u7f29\u7ed3\u675f")},done:function(a){console.log(a);a&&a.base64&&d.ajax_uploadByphone(a.base64)}})},upload_files_arr:[],bind_onchange:function(a,c){d.upload_files_arr=[];d.groupuuid=null;d.callbackFN=c;G_CallPhoneFN.isPhoneApp()?$(a).bind("click",function(){G_CallPhoneFN.selectImgPic()}):$(a).bind("change",function(){for(var a=0;a<this.files.length;a++)d.upload_files_arr.push(this.files[a]);d.do_lrz()})},ajax_uploadByphone:function(a){$.AMUI.progress.start();formObject=$("#KdPhotoForm").serializeJson();formObject.base64=a;$.ajax({type:"POST",url:hostUrl+"rest/kDPhotoItem/uploadBase64.json",timeout:0,dataType:"json",data:formObject,async:!0,success:function(a){$.AMUI.progress.done();"success"==a.ResMsg.status?d.callbackFN&&(d.callbackFN(a.imgUrl,a.data.uuid),d.do_lrz()):alert(a.ResMsg.message)},error:G_ajax_error_fn})}},h=React.createClass({displayName:"Query_photo_rect",getInitialState:function(){return{groupuuid:this.props.groupuuid,class_uuid:this.props.class_uuid,pageNo:this.props.pageNo}},handleChange_selectClass:function(a){this.state.class_uuid=a;this.setState(this.state);menu_photo_fn(this.state.groupuuid,a,this.state.pageNo)},handleChange_selectGroup:function(a){this.state.groupuuid=a;this.state.class_uuid=null;this.setState(this.state);menu_photo_fn(a,this.state.class_uuid,this.state.pageNo)},handleClick:function(a){React.render(React.createElement(g,{formdata:a}),G_get_div_body())},pageClick:function(a,c){var b=this.state,d=c.list.data,e=c.list.pageSize;"pre"==a?2>b.pageNo?G_msg_pop("\u7b2c\u4e00\u9875\u4e86"):(--b.pageNo,menu_photo_fn(b.groupuuid,b.class_uuid,b.pageNo)):"next"==a&&(!d||d.length<e?G_msg_pop("\u6700\u540e\u4e00\u9875\u4e86"):(b.pageNo+=1,menu_photo_fn(b.groupuuid,b.class_uuid,b.pageNo)))},render:function(){var a=this.state,c=this.props.formdata,b=c.list.data;return React.createElement("div",null,React.createElement("div",{className:"header"},React.createElement("hr",null)),React.createElement(AMR_Panel,null,React.createElement(AMR_ButtonToolbar,null,React.createElement(AMR_Button,{amStyle:"default",onClick:this.pageClick.bind(this,"pre",c)},"\u4e0a\u4e00\u9875"),React.createElement(AMR_Button,{amStyle:"default",disabled:"false"},"\u7b2c",a.pageNo,"\u9875"),React.createElement(AMR_Button,{amStyle:"default",onClick:this.pageClick.bind(this,"next",c)},"\u4e0b\u4e00\u9875"),React.createElement(AMR_Button,{amSize:"xs",amStyle:"secondary",onClick:this.handleClick.bind(this,a)},"\u4e0a\u4f20\u7167\u7247"))),React.createElement(AMR_ButtonToolbar,null,React.createElement("div",{className:"am-fl am-margin-left-sm am-margin-bottom-xs"},React.createElement(AMUIReact.Selected,{id:"groupuuid",name:"groupuuid",onChange:this.handleChange_selectGroup,btnWidth:"200",data:this.props.group_List,btnStyle:"primary",value:a.groupuuid})),React.createElement("div",{className:"am-fl am-margin-left-sm am-margin-bottom-xs"},React.createElement(AMUIReact.Selected,{id:"classuuid",name:"classuuid",placeholder:"\u73ed\u7ea7\u5207\u6362",onChange:this.handleChange_selectClass,btnWidth:"200",data:this.props.classList,btnStyle:"primary",value:a.class_uuid}))),b.map(function(a){return React.createElement(AMUIReact.Image,{className:"am-show",id:"img_image",thumbnail:!0,width:"120",height:"120",src:a.path})}))}}),g=React.createClass({displayName:"Img_photo_rect",buttion_black_Click:function(a){menu_photo_fn(a.groupuuid,a.class_uuid,a.pageNo)},imgDivNum:0,getNewImgDiv:function(){this.imgDivNum++;return"Classnews_edit_"+this.imgDivNum},addShowImg:function(a){var c=this.getNewImgDiv();$("#show_imgList").append("\x3cdiv id\x3d'"+c+"'\x3e\u52a0\u8f7d\u4e2d...\x3c/div\x3e");React.render(React.createElement(ClassNews_Img_canDel,{url:a,parentDivId:c}),document.getElementById(c))},upload_files_arr:[],componentDidMount:function(){this.editor=$("#classnews_content").xheditor(xhEditor_classnews_emot);var a=this;d.bind_onchange("#file_img_upload",function(b,c){a.addShowImg(b)});d.groupuuid=this.props.formdata.groupuuid;if($("#imgs").val())for(var c=$("#imgs").val().split(","),b=0;b<c.length;b++)this.addShowImg(c[b])},render:function(){var a=this.props.formdata;return React.createElement("div",null,React.createElement("div",{className:"header"},React.createElement("hr",null)),React.createElement("div",{className:"am-g"},React.createElement("form",{id:"KdPhotoForm",method:"post",className:"am-form"},React.createElement("input",{type:"hidden",name:"group_uuid",value:a.groupuuid}),React.createElement("input",{type:"hidden",name:"class_uuid",value:a.class_uuid}),React.createElement(AMR_ButtonToolbar,null,React.createElement(AMR_Button,{amSize:"xs",amStyle:"secondary",onClick:this.buttion_black_Click.bind(this,a)},"\u8fd4\u56de"))),React.createElement("div",{id:"show_imgList"}),React.createElement("br",null),React.createElement("div",{className:"cls"}),React.createElement(AMR_Input,{type:"file",label:"",id:"file_img_upload",help:"\u9009\u62e9\u56fe\u7247",accept:"image/*",capture:"camera",multiple:!0})))}});return{query:function(a,c,b){var d,e=Store.getGroup();d=a?a:e[0].uuid;var f=Store.getChooseClass(d);b||(b=1);c||(c=f&&0!=f.length?f[0].uuid:null);$.ajax({type:"GET",url:hostUrl+"rest/kDPhotoItem/queryMy.json",data:{class_uuid:c,pageNo:b},dataType:"json",success:function(a){"success"==a.ResMsg.status?React.render(React.createElement(h,{formdata:a,groupuuid:d,pageNo:a.list.pageNo,group_List:G_selected_dataModelArray_byArray(e,"uuid","brand_name"),classList:G_selected_dataModelArray_byArray(f,"uuid","name"),class_uuid:c}),G_get_div_body()):alert("\u52a0\u8f7d\u6570\u636e\u5931\u8d25\uff1a"+a.ResMsg.message)},error:G_ajax_error_fn})}}}();